<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Login â€” Shared Expense Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  </head>
  <body>
    <div class="container mt-5">
      <div class="row justify-content-center">
        <div class="col-md-6">
          <div class="card">
            <div class="card-body">
              <h3 class="card-title">Please sign in</h3>
              {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                  {% for cat, msg in messages %}
                    <div class="alert alert-{{ 'success' if cat=='success' else 'danger' }}">{{ msg }}</div>
                  {% endfor %}
                {% endif %}
              {% endwith %}
              <form method="post">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <div class="mb-3">
                  <label class="form-label">Username</label>
                  <input name="username" class="form-control" required>
                </div>
                <div class="mb-3">
                  <label class="form-label">Password</label>
                  <input type="password" name="password" class="form-control" required>
                </div>
                <button class="btn btn-primary">Sign in</button>
              </form>
              <hr>
              <p class="text-center text-muted mb-0">
                Don't have an account? <a href="{{ url_for('signup') }}">Sign up with email</a>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.addEventListener('click', function(e){
      if (e.target && e.target.classList && e.target.classList.contains('btn-close')) {
        const a = e.target.closest('.alert');
        if (a) a.remove();
      }
    });

    // Auto-dismiss success alerts after a short delay
    window.addEventListener('load', function(){
      document.querySelectorAll('.alert.alert-success').forEach(function(a){
        setTimeout(function(){
          try { a.classList.remove('show'); } catch(e){}
          if (a.parentNode) a.parentNode.removeChild(a);
        }, 6000);
      });
    });
  </script>
  </body>
</html>
